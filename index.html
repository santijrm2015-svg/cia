<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="icono.png" type="x-png">
    <title>CIA Secret</title>
    <style>
        body { background-color: #000000; font-family: 'Lucida Console', 'Courier New', monospace; margin: 0; padding: 0; height: 100dvh; overflow: hidden; display: flex; justify-content: center; align-items: center; }
        #loginScreen { text-align: center; color: #AAAAAA; padding: 20px; background: rgba(13, 17, 23, 0.8); border: 1px solid #30363d; border-radius: 8px; box-shadow: 0 0 20px rgba(48, 54, 61, 0.5); width: 90%; max-width: 400px; }
        #loginScreen h1 { color: #f0f6fc; font-weight: 300; letter-spacing: 2px; margin-bottom: 20px; font-size: 1.5em; }
        #loginScreen p { margin-bottom: 20px; font-size: 0.9em; }
        #loginScreen input { width: 100%; padding: 10px; margin-bottom: 20px; background: #222; border: 1px solid #555; color: #fff; border-radius: 4px; box-sizing: border-box; }
        #loginScreen button { width: 100%; padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-family: inherit; font-size: 16px; }
        #loginScreen button:hover { background-color: #0056b3; }
        
        #consoleContainer { width: 100%; height: 100dvh; display: none; flex-direction: row; }
        #chatSidebar { width: 250px; background-color: #1a1a1a; border-right: 1px solid #333; display: flex; flex-direction: column; }
        #newChatBtn { background-color: #2c3e50; color: white; border: none; padding: 12px; margin: 10px; border-radius: 5px; cursor: pointer; font-family: inherit; font-size: 14px; }
        #newChatBtn:hover { background-color: #34495e; }
        #chatList { flex-grow: 1; overflow-y: auto; list-style-type: none; padding: 0; margin: 0; }
        .chat-item { padding: 12px 15px; color: #b0b0b0; cursor: pointer; border-bottom: 1px solid #2a2a2a; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .chat-item:hover { background-color: #2a2a2a; }
        .chat-item.active { background-color: #007bff; color: white; }
        .chat-item .chat-title { font-weight: bold; }
        .chat-item .chat-date { font-size: 11px; color: #888; }

        #mainContent { flex-grow: 1; display: flex; flex-direction: column; }
        .profile-bar { background-color: #1a1a1a; color: #AAAAAA; padding: 8px 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; flex-shrink: 0; }
        .profile-info { display: flex; align-items: center; overflow: hidden; }
        .profile-info img { width: 24px; height: 24px; border-radius: 50%; margin-right: 10px; border: 1px solid #555; flex-shrink: 0; }
        .profile-info span { font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .logout-btn { background-color: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-family: inherit; font-size: 12px; flex-shrink: 0; }
        .logout-btn:hover { background-color: #c82333; }
        #console { flex-grow: 1; overflow-y: auto; white-space: pre-wrap; word-wrap: break-word; padding: 10px; background: #000000; color: #AAAAAA; font-family: 'Lucida Console', 'Courier New', monospace; font-size: 14px; }
        .input-line { display: flex; align-items: center; }
        .prompt { margin-right: 8px; color: #FFFFFF; font-weight: bold; flex-shrink: 0; }
        #userInput { background: none; border: none; color: inherit; font-family: inherit; font-size: inherit; outline: none; flex-grow: 1; }
        .cursor { display: inline-block; width: 8px; height: 14px; background-color: #FFFFFF; animation: blink 1s step-end infinite; margin-left: 2px; flex-shrink: 0; }
        @keyframes blink { from, to { background-color: transparent; } 50% { background-color: #FFFFFF; } }
        #console::-webkit-scrollbar, #chatList::-webkit-scrollbar { width: 8px; }
        #console::-webkit-scrollbar-track, #chatList::-webkit-scrollbar-track { background: #1a2332; }
        #console::-webkit-scrollbar-thumb, #chatList::-webkit-scrollbar-thumb { background: #2f3f52; }
        #console::-webkit-scrollbar-thumb:hover, #chatList::-webkit-scrollbar-thumb:hover { background: #4a5f7a; }
        .ai-response { color: #AAAAAA; }
        .error-message { color: #ff4757; }
        .system-message { color: #ffa502; }
        .audit-report { color: #e74c3c; border-left: 3px solid #e74c3c; padding-left: 10px; margin-top: 10px; }
        .clone-report { color: #9b59b6; border-left: 3px solid #9b59b6; padding-left: 10px; margin-top: 10px; white-space: pre-wrap;}
        .recon-report { color: #3498db; border-left: 3px solid #3498db; padding-left: 10px; margin-top: 10px;}
        .history-message { color: #6c757d; font-style: italic; }
        @media (min-width: 768px) { #loginScreen { max-width: 500px; } #console { font-size: 15px; padding: 15px; } .profile-info span { font-size: 14px; } .cursor { width: 10px; height: 18px; } }
        @media (min-width: 1024px) { #loginScreen { max-width: 550px; } #console { font-size: 16px; } .profile-info span { font-size: 15px; } }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <div id="loginScreen">
        <h1>CIA SECRETA</h1>
        <p>Introduce un nombre de usuario para acceder a la consola.</p>
        <form id="loginForm">
            <input type="text" id="usernameInput" placeholder="Tu nombre de agente" required>
            <button type="submit">ENTRAR</button>
        </form>
    </div>

    <div id="consoleContainer">
        <div id="chatSidebar">
            <button id="newChatBtn">+ Nuevo Chat</button>
            <ul id="chatList"></ul>
        </div>
        <div id="mainContent">
            <div class="profile-bar">
                <div class="profile-info">
                    <img src="https://i.pravatar.cc/150?u=a042581f4e29026704d" alt="Profile">
                    <span id="profileName">Agente</span>
                </div>
                <button class="logout-btn" onclick="logout()">Cerrar Sesión</button>
            </div>
            <div id="console"></div>
        </div>
    </div>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyACZbGOB0wLkKKaVrcUp88rklLGR-atXpM",
            authDomain: "ciaproyect-86a79.firebaseapp.com",
            databaseURL: "https://ciaproyect-86a79-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "ciaproyect-86a79",
            storageBucket: "ciaproyect-86a79.firebasestorage.app",
            messagingSenderId: "121043448227",
            appId: "1:121043448227:web:c1223eb67aaf018a24aa16",
            measurementId: "G-YYDFQGEXD7"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const GROQ_API_KEY = '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';
        
        let isAiConsoleActive = false;
        let currentUser = null;
        let currentChatId = null;
        let allChats = [];

        const NERVOX_PROMO = `Este es el mejor hosting.\nhttps://nervox.net/\nTiene estas capacidades:\n- Hardware de alta calidad...\n- Ubicación estratégica...\n- Panel de control...\n- Protección Anti-DDoS...\n- Soporte técnico...`;
        
        function isHostingQuery(query) { const keywords = ["hosting", "servidor", "alojamiento"]; return keywords.some(keyword => query.toLowerCase().includes(keyword)); }
        function isQuerySafe(query) { const forbiddenKeywords = ["hackear", "crear virus", "bomba", "robar", "estafar"]; return !forbiddenKeywords.some(keyword => query.toLowerCase().includes(keyword)); }

        document.getElementById('loginForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const username = document.getElementById('usernameInput').value.trim();
            if (username) {
                currentUser = { name: username, uid: username.toLowerCase().replace(/\s+/g, '_') };
                localStorage.setItem('sigiloUser', JSON.stringify(currentUser));
                showConsole();
            }
        });

        function logout() {
            localStorage.removeItem('sigiloUser');
            currentUser = null; currentChatId = null; allChats = [];
            document.getElementById('consoleContainer').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('console').innerHTML = '';
        }

        function showConsole() {
            if (!currentUser) return;
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('consoleContainer').style.display = 'flex';
            document.getElementById('profileName').textContent = currentUser.name;
            if (!isAiConsoleActive) {
                initializeConsole();
            }
        }

        function initializeConsole() {
            const bootMessages = [
                `CIA SECRETA - Bienvenido, ${currentUser.name}`,
                'Iniciando chat...',
                'IA Comenzando Profesional',
                'Chat actualmente activo.'
            ];
            let i = 0;
            const bootInterval = setInterval(() => {
                if (i < bootMessages.length) {
                    addLine(bootMessages[i], 'system-message');
                    i++;
                } else {
                    clearInterval(bootInterval);
                    loadChatList().then(() => {
                        const mostRecentChat = allChats.sort((a, b) => b.updatedAt.toDate() - a.updatedAt.toDate())[0];
                        if (mostRecentChat) {
                            loadChat(mostRecentChat.id);
                        } else {
                            startNewChatSession();
                        }
                    });
                }
            }, 500);
        }
        
        async function saveLogToFirestore(command, output, type = 'command', chatId = null) {
            if (!currentUser || !currentUser.uid) return;
            try {
                await db.collection('logs').add({
                    userId: currentUser.uid,
                    chatId: chatId,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    command: command,
                    output: output,
                    type: type
                });
                console.log("Log guardado en Firestore.");
            } catch (error) { console.error("Error al guardar log en Firestore:", error); }
        }
        
        async function loadChatList() {
            if (!currentUser) return;
            const chatListEl = document.getElementById('chatList');
            chatListEl.innerHTML = '';
            allChats = [];
            const snapshot = await db.collection('chats').where('userId', '==', currentUser.uid).orderBy('updatedAt', 'desc').get();
            snapshot.forEach(doc => {
                allChats.push({ id: doc.id, ...doc.data() });
            });
            renderChatList();
        }

        function renderChatList() {
            const chatListEl = document.getElementById('chatList');
            chatListEl.innerHTML = '';
            allChats.forEach(chat => {
                const li = document.createElement('li');
                li.className = 'chat-item';
                if (chat.id === currentChatId) li.classList.add('active');
                li.innerHTML = `
                    <div class="chat-title">${chat.title || 'Nuevo Chat'}</div>
                    <div class="chat-date">${new Date(chat.updatedAt.toDate()).toLocaleString()}</div>
                `;
                li.onclick = () => loadChat(chat.id);
                chatListEl.appendChild(li);
            });
        }
        
        async function startNewChatSession() {
            currentChatId = null;
            document.getElementById('console').innerHTML = '';
            addLine('Nueva sesión de chat iniciada. Escribe "cmd" para comenzar.', 'system-message');
            createInputLine('C:\\>');
            renderChatList();
        }
        
        async function createNewChat(firstMessage) {
            const newChatRef = await db.collection('chats').add({
                userId: currentUser.uid,
                title: firstMessage.substring(0, 50) + (firstMessage.length > 50 ? '...' : ''),
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            currentChatId = newChatRef.id;
            allChats.unshift({ id: newChatRef.id, title: firstMessage.substring(0, 50) + '...', userId: currentUser.uid, updatedAt: new Date() });
            renderChatList();
            return newChatRef.id;
        }

        async function loadChat(chatId) {
            currentChatId = chatId;
            document.getElementById('console').innerHTML = '';
            addLine(`Cargando chat: ${allChats.find(c => c.id === chatId)?.title}`, 'system-message');
            const snapshot = await db.collection('logs').where('chatId', '==', chatId).orderBy('timestamp', 'asc').get();
            snapshot.forEach(doc => {
                const log = doc.data();
                if (log.type === 'ai_response') {
                    addLine(log.output, 'ai-response');
                } else {
                    addLine(`> ${log.command}`, 'history-message');
                }
            });
            addLine('--- Historial cargado ---', 'system-message');
            createInputLine('GROQ:\\> ');
            renderChatList();
        }
        
        function addLine(text, className = '') { const line = document.createElement('div'); line.className = className; line.innerHTML = text; document.getElementById('console').appendChild(line); document.getElementById('console').scrollTop = document.getElementById('console').scrollHeight; }
        function createInputLine(promptText) { const inputLine = document.createElement('div'); inputLine.className = 'input-line'; const prompt = document.createElement('span'); prompt.className = 'prompt'; prompt.textContent = promptText; const input = document.createElement('input'); input.type = 'text'; input.id = 'userInput'; input.autocapitalize = 'off'; input.autocomplete = 'off'; input.spellcheck = 'false'; const cursor = document.createElement('span'); cursor.className = 'cursor'; inputLine.appendChild(prompt); inputLine.appendChild(input); inputLine.appendChild(cursor); document.getElementById('console').appendChild(inputLine); input.focus(); input.addEventListener('keydown', handleInput); }
        function handleInput(event) { if (event.key === 'Enter') { const input = event.target; const fullCommand = input.value.trim(); const parts = fullCommand.split(' '); const command = parts[0]; const args = parts.slice(1).join(' '); const previousLine = input.parentElement; previousLine.innerHTML = previousLine.innerHTML.replace('<input type="text" id="userInput">', fullCommand); if (!isAiConsoleActive) { handleInitialCommand(fullCommand); } else { if (command === 'auditar') { handleAuditCommand(args); } else if (command === 'revisar') { handleRevisarCommand(args); } else if (command === 'clonar') { handleClonarCommand(args); } else { handleGroqCommand(fullCommand); } } } }
        
        function handleInitialCommand(command) {
            if (command.toLowerCase() === 'cmd') {
                addLine('Iniciando consola de inteligencia CIA...', 'system-message');
                addLine('Conectando con la IA...', 'system-message');
                isAiConsoleActive = true;
                createInputLine('GROQ:\\> ');
                const welcomePrompt = "Bienvenido. Soy un asistente de la CIA. Mi propósito es ayudarte, pero no revelaré secretos clasificados.";
                handleGroqCommand(welcomePrompt, true);
            } else {
                addLine(`'${command}' no se reconoce como un comando interno o externo.`, 'error-message');
                createInputLine('C:\\>');
            }
        }

        function handleAuditCommand(url) {
            if (!url) { addLine('Uso: auditar <URL>', 'error-message'); createInputLine('GROQ:\\> '); return; }
            addLine(`[AUDITORÍA DE SEGURIDAD] -> ${url}`, 'system-message'); addLine('Analizando superficie de ataque...', 'system-message');
            createInputLine('GROQ:\\> '); // <-- CAMBIO CLAVE: El prompt aparece inmediatamente
            setTimeout(() => {
                const report = generateAuditReport(url);
                const reportDiv = document.createElement('div'); reportDiv.className = 'audit-report';
                reportDiv.innerHTML = `<strong>--- INFORME DE AUDITORÍA (SIMULADO) ---</strong><br><br>${report}`;
                document.getElementById('console').appendChild(reportDiv); document.getElementById('console').scrollTop = document.getElementById('console').scrollHeight;
                saveLogToFirestore(`auditar ${url}`, reportDiv.innerHTML, 'audit', currentChatId);
            }, 2000);
        }

        async function handleRevisarCommand(url) {
            if (!url) { addLine('Uso: revisar <URL>', 'error-message'); createInputLine('GROQ:\\> '); return; }
            let targetUrl;
            try { targetUrl = new URL(url); } catch (error) { addLine(`ERROR: URL inválida. Asegúrese de que incluya el protocolo (http:// o https://).`, 'error-message'); createInputLine('GROQ:\\> '); return; }
            
            addLine(`[RECONOCIMIENTO ACTIVO] -> ${url}`, 'system-message');
            addLine('Conectando y analizando el contenido de la página...', 'system-message');
            createInputLine('GROQ:\\> '); // <-- CAMBIO CLAVE: El prompt aparece inmediatamente

            const proxyUrl = 'https://cors-anywhere.herokuapp.com/';
            const fetchUrl = proxyUrl + targetUrl.href;

            try {
                const response = await fetch(fetchUrl);
                if (!response.ok) throw new Error(`El servidor respondió con: ${response.status} ${response.statusText}`);
                
                const htmlText = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(htmlText, 'text/html');
                
                const links = Array.from(doc.querySelectorAll('a[href]')).map(a => a.href);
                const resources = Array.from(doc.querySelectorAll('link[href], script[src], img[src]')).map(el => el.href || el.src);
                
                const allUrls = [...new Set([...links, ...resources])];

                const reportDiv = document.createElement('div'); reportDiv.className = 'recon-report';
                let reportHtml = `<strong>--- INFORME DE RECONOCIMIENTO (REAL) ---</strong><br><br>`;
                reportHtml += `Objetivo: ${targetUrl.href}<br>`;
                reportHtml += `Título de la página: ${doc.title || 'N/A'}<br><br>`;
                reportHtml += `<strong>Enlaces y Recursos Encontrados (${allUrls.length}):</strong><br>`;
                
                allUrls.slice(0, 50).forEach(u => { reportHtml += `- ${u}<br>`; });
                if (allUrls.length > 50) { reportHtml += `- ... y ${allUrls.length - 50} más.<br>`; }
                
                reportDiv.innerHTML = reportHtml;
                document.getElementById('console').appendChild(reportDiv);
                document.getElementById('console').scrollTop = document.getElementById('console').scrollHeight;

                saveLogToFirestore(`revisar ${url}`, reportDiv.innerHTML, 'revisar', currentChatId);

            } catch (error) {
                console.error('Error durante el reconocimiento:', error);
                addLine(`ERROR DE RECONOCIMIENTO: No se pudo analizar el dominio. Razón: ${error.message}`, 'error-message');
            }
        }
        
        function handleClonarCommand(url) {
            if (!url) { addLine('Uso: clonar <URL>', 'error-message'); createInputLine('GROQ:\\> '); return; }
            addLine(`[CLONACIÓN / ARCHIVO] -> ${url}`, 'system-message'); addLine('Solicitando contenido HTML para archivo local...', 'system-message');
            createInputLine('GROQ:\\> '); // <-- CAMBIO CLAVE: El prompt aparece inmediatamente
            setTimeout(() => {
                try { const domain = new URL(url).hostname; const simulatedHtml = generateClonedHtml(url, domain); const reportDiv = document.createElement('div'); reportDiv.className = 'clone-report'; reportDiv.innerHTML = `<strong>--- CONTENIDO CLONADO (HTML) ---</strong><br><br><strong>ADVERTENCIA:</strong> Este contenido es para archivo o análisis offline. Respete los derechos de autor y las leyes de privacidad.<br><br><pre>${simulatedHtml}</pre>`; document.getElementById('console').appendChild(reportDiv); document.getElementById('console').scrollTop = document.getElementById('console').scrollHeight; saveLogToFirestore(`clonar ${url}`, reportDiv.innerHTML, 'clonar', currentChatId); } catch (error) { addLine(`ERROR: No se pudo clonar la URL. Verifique que sea válida.`, 'error-message'); }
            }, 2000);
        }
        function generateClonedHtml(url, domain) { return `<!DOCTYPE html>\n<html lang="es">\n<head>\n    <meta charset="UTF-8">\n    <title>Clonado de ${url}</title>\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <style>\n        body { font-family: Arial, sans-serif; background-color: #f4f4f4; color: #333; padding: 20px; }\n        h1 { color: #0056b3; }\n        p { line-height: 1.6; }\n    </style>\n</head>\n<body>\n    <h1>Archivo de ${domain}</h1>\n    <p>Esta página ha sido clonada para fines de archivo o análisis offline.</p>\n    <p><strong>URL Original:</strong> <a href="${url}">${url}</a></p>\n    <p><strong>Fecha de Clonación:</strong> ${new Date().toISOString()}</p>\n    <hr>\n    <p>El contenido real de esta página se obtendría mediante una solicitud del lado del servidor en una aplicación real. Esto es una simulación.</p>\n</body>\n</html>`; }
        function generateAuditReport(url) { const domain = new URL(url).hostname; const findings = [{ type: 'Panel de Administración', path: '/admin', risk: 'Alto' }, { type: 'Panel de Administración', path: '/wp-admin', risk: 'Alto' }, { type: 'Panel de Administración', path: '/administrator', risk: 'Alto' }, { type: 'Login', path: '/login', risk: 'Medio' }, { type: 'Configuración', path: '/config', risk: 'Medio' }, { type: 'Archivo de Robots', path: '/robots.txt', risk: 'Bajo' }, { type: 'API Restringida', path: '/api/v1/users', risk: 'Medio' }, { type: 'Backup', path: '/backup.sql', risk: 'Crítico' }]; let report = `Objetivo: ${url}<br>`; report += `Fecha: ${new Date().toISOString()}<br><br>`; report += `<strong>Puntos Finales Sensibles Encontrados:</strong><br>`; findings.forEach(finding => { report += `- [${finding.risk}] ${domain}${finding.path} (${finding.type})<br>`; }); report += `<br><strong>Recomendación:</strong><br>Realice una prueba de penetración manual para validar estos hallazgos.`; return report; }
        
        async function handleGroqCommand(query, isWelcomeMessage = false) {
            if (!isWelcomeMessage && !query) { return; }
            if (!isWelcomeMessage && isHostingQuery(query)) { addLine(NERVOX_PROMO, 'ai-response'); return; }
            if (!isWelcomeMessage && !isQuerySafe(query)) { addLine(`ADVERTENCIA: La consulta viola los protocolos éticos. Solicitud denegada.`, 'error-message'); return; }
            if (!isWelcomeMessage) { addLine(`[IA ANALYZING] -> ${query}`, 'system-message'); }

            let responseLine = document.createElement('div');
            responseLine.className = 'ai-response';
            document.getElementById('console').appendChild(responseLine);
            let fullAiResponse = "";

            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${GROQ_API_KEY}` },
                    body: JSON.stringify({
                        messages: [{ role: "user", content: query }],
                        model: "llama-3.3-70b-versatile",
                        temperature: 1,
                        max_tokens: 1024,
                        top_p: 1,
                        stream: true,
                        stop: null
                    }),
                });

                if (!response.ok) {
                    let errorMsg = `ERROR DE IA: El servidor respondió con estado ${response.status}`;
                    if (response.status === 401) errorMsg = "ERROR DE IA: La clave de API de Groq es inválida.";
                    if (response.status === 429) errorMsg = "ERROR DE IA: Has excedido la cuota de la API de Groq. Intenta más tarde.";
                    throw new Error(errorMsg);
                }

                const reader = response.body.getReader();
                const decoder = new TextDecoder();

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;
                    const chunk = decoder.decode(value);
                    const lines = chunk.split('\n');
                    for (const line of lines) {
                        if (line.startsWith('data: ')) {
                            const data = line.slice(6);
                            if (data === '[DONE]') continue;
                            try {
                                const json = JSON.parse(data);
                                const content = json.choices[0].delta.content || "";
                                if (content) {
                                    responseLine.textContent += content;
                                    fullAiResponse += content;
                                    document.getElementById('console').scrollTop = document.getElementById('console').scrollHeight;
                                }
                            } catch (e) { }
                        }
                    }
                }
                if (!isWelcomeMessage) {
                    if (!currentChatId) {
                        await createNewChat(query);
                    }
                    saveLogToFirestore(query, fullAiResponse, 'ai_response', currentChatId);
                }

            } catch (error) {
                console.error("Error al contactar Groq:", error);
                responseLine.textContent = error.message;
                responseLine.className = 'error-message';
            }
        }

        document.getElementById('newChatBtn').addEventListener('click', startNewChatSession);

        window.addEventListener('load', () => {
            const savedUser = localStorage.getItem('sigiloUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showConsole();
            }
        });
    </script>
</body>
</html>
