<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="icono.png" type="x-png">
    <title>CIA Secret</title>
    <style>
        body { background-color: #000000; font-family: 'Lucida Console', 'Courier New', monospace; margin: 0; padding: 0; height: 100dvh; overflow: hidden; display: flex; justify-content: center; align-items: center; }
        #loginScreen { text-align: center; color: #AAAAAA; padding: 20px; background: rgba(13, 17, 23, 0.8); border: 1px solid #30363d; border-radius: 8px; box-shadow: 0 0 20px rgba(48, 54, 61, 0.5); width: 90%; max-width: 400px; }
        #loginScreen h1 { color: #f0f6fc; font-weight: 300; letter-spacing: 2px; margin-bottom: 20px; font-size: 1.5em; }
        #loginScreen p { margin-bottom: 30px; font-size: 0.9em; }
        #consoleContainer { width: 100%; height: 100dvh; display: none; flex-direction: column; }
        .profile-bar { background-color: #1a1a1a; color: #AAAAAA; padding: 8px 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; flex-shrink: 0; }
        .profile-info { display: flex; align-items: center; overflow: hidden; }
        .profile-info img { width: 24px; height: 24px; border-radius: 50%; margin-right: 10px; border: 1px solid #555; flex-shrink: 0; }
        .profile-info span { font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .logout-btn { background-color: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-family: inherit; font-size: 12px; flex-shrink: 0; }
        .logout-btn:hover { background-color: #c82333; }
        #console { flex-grow: 1; overflow-y: auto; white-space: pre-wrap; word-wrap: break-word; padding: 10px; background: #000000; color: #AAAAAA; font-family: 'Lucida Console', 'Courier New', monospace; font-size: 14px; }
        .input-line { display: flex; align-items: center; }
        .prompt { margin-right: 8px; color: #FFFFFF; font-weight: bold; flex-shrink: 0; }
        #userInput { background: none; border: none; color: inherit; font-family: inherit; font-size: inherit; outline: none; flex-grow: 1; }
        .cursor { display: inline-block; width: 8px; height: 14px; background-color: #FFFFFF; animation: blink 1s step-end infinite; margin-left: 2px; flex-shrink: 0; }
        @keyframes blink { from, to { background-color: transparent; } 50% { background-color: #FFFFFF; } }
        #console::-webkit-scrollbar { width: 8px; }
        #console::-webkit-scrollbar-track { background: #1a2332; }
        #console::-webkit-scrollbar-thumb { background: #2f3f52; }
        #console::-webkit-scrollbar-thumb:hover { background: #4a5f7a; }
        .ai-response { color: #AAAAAA; }
        .error-message { color: #ff4757; }
        .system-message { color: #ffa502; }
        .recon-report { color: #3498db; border-left: 3px solid #3498db; padding-left: 10px; margin-top: 10px;}
        @media (min-width: 768px) { #loginScreen { max-width: 500px; } #console { font-size: 15px; padding: 15px; } .profile-info span { font-size: 14px; } .cursor { width: 10px; height: 18px; } }
        @media (min-width: 1024px) { #loginScreen { max-width: 550px; } #console { font-size: 16px; } .profile-info span { font-size: 15px; } }
    </style>
</head>
<body>
    <div id="loginScreen">
        <h1>CIA SECRETA</h1>
        <p>Para acceder a la consola de inteligencia, por favor, autentíquese.</p>
        <div id="g_id_onload" data-client_id="544671613331-5glj9smclnakr9msr7vkastgon9tq03v.apps.googleusercontent.com" data-context="signin" data-ux_mode="popup" data-callback="handleSignIn" data-auto_prompt="false"></div>
        <div class="g_id_signin" data-type="standard" data-shape="rectangular" data-theme="filled_black" data-text="signin_with" data-size="large" data-logo_alignment="left"></div>
    </div>
    <div id="consoleContainer">
        <div class="profile-bar">
            <div class="profile-info">
                <img id="profilePicture" src="" alt="Profile">
                <span id="profileName">Usuario</span>
            </div>
            <button class="logout-btn" onclick="logout()">Cerrar Sesión</button>
        </div>
        <div id="console"></div>
    </div>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script>
        const GROQ_API_KEY = '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';
        let isAiConsoleActive = false;
        let currentUser = null;
        const NERVOX_PROMO = `Este es el mejor hosting.\nhttps://nervox.net/\nTiene estas capacidades:\n- Hardware de alta calidad...\n- Ubicación estratégica...\n- Panel de control...\n- Protección Anti-DDoS...\n- Soporte técnico...`;
        function isHostingQuery(query) { const keywords = ["hosting", "servidor", "alojamiento"]; return keywords.some(keyword => query.toLowerCase().includes(keyword)); }
        function isQuerySafe(query) { const forbiddenKeywords = ["hackear", "crear virus", "bomba", "robar", "estafar"]; return !forbiddenKeywords.some(keyword => query.toLowerCase().includes(keyword)); }
        function handleSignIn(response) { try { const payload = jwt_decode(response.credential); currentUser = { name: payload.name, email: payload.email, picture: payload.picture }; localStorage.setItem('sigiloUser', JSON.stringify(currentUser)); showConsole(); } catch (error) { console.error("Error al decodificar el token de Google:", error); alert("Error de autenticación. Por favor, inténtelo de nuevo."); } }
        function logout() { localStorage.removeItem('sigiloUser'); currentUser = null; document.getElementById('consoleContainer').style.display = 'none'; document.getElementById('loginScreen').style.display = 'flex'; isAiConsoleActive = false; document.getElementById('console').innerHTML = ''; }
        function showConsole() { if (!currentUser) return; document.getElementById('loginScreen').style.display = 'none'; document.getElementById('consoleContainer').style.display = 'flex'; document.getElementById('profileName').textContent = currentUser.name; document.getElementById('profilePicture').src = currentUser.picture; if (!isAiConsoleActive) { initializeConsole(); } }
        function initializeConsole() { const bootMessages = [`CIA SECRETA - Bienvenido, ${currentUser.name}`, 'Copyright (c) 2026 CIA. All rights reserved.', '', 'Cargando controladores de red... OK', 'Inicializando subsistemas criptográficos... OK', 'Verificando integridad del núcleo... OK', 'Activando Protocolo de Seguridad (PSC) y Respuesta Directa (PRD)... OK', '', 'Motor de IA: Groq (Llama 3.3 70B) - Streaming activado.', 'Para iniciar la consola, escriba: cmd']; let i = 0; const bootInterval = setInterval(() => { if (i < bootMessages.length) { addLine(bootMessages[i], 'system-message'); i++; } else { clearInterval(bootInterval); createInputLine('C:\\>'); } }, 300); }
        function jwt_decode(token) { const base64Url = token.split('.')[1]; const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/'); const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) { return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2); }).join('')); return JSON.parse(jsonPayload); }
        function addLine(text, className = '') { const line = document.createElement('div'); line.className = className; line.textContent = text; document.getElementById('console').appendChild(line); document.getElementById('console').scrollTop = document.getElementById('console').scrollHeight; }
        function createInputLine(promptText) { const inputLine = document.createElement('div'); inputLine.className = 'input-line'; const prompt = document.createElement('span'); prompt.className = 'prompt'; prompt.textContent = promptText; const input = document.createElement('input'); input.type = 'text'; input.id = 'userInput'; input.autocapitalize = 'off'; input.autocomplete = 'off'; input.spellcheck = 'false'; const cursor = document.createElement('span'); cursor.className = 'cursor'; inputLine.appendChild(prompt); inputLine.appendChild(input); inputLine.appendChild(cursor); document.getElementById('console').appendChild(inputLine); input.focus(); input.addEventListener('keydown', handleInput); }
        function handleInput(event) { if (event.key === 'Enter') { const input = event.target; const fullCommand = input.value.trim(); const parts = fullCommand.split(' '); const command = parts[0]; const args = parts.slice(1).join(' '); const previousLine = input.parentElement; previousLine.innerHTML = previousLine.innerHTML.replace('<input type="text" id="userInput">', fullCommand); if (!isAiConsoleActive) { handleInitialCommand(fullCommand); } else { if (command === 'auditar') { handleAuditCommand(args); } else if (command === 'revisar') { handleRevisarCommand(args); } else { handleGroqCommand(fullCommand); } } } }
        function handleInitialCommand(command) { if (command.toLowerCase() === 'cmd') { addLine('Iniciando consola de inteligencia CIA...', 'system-message'); isAiConsoleActive = true; createInputLine('GROQ:\\> '); const welcomePrompt = "Saluda de forma elegante y preséntate como un asistente de inteligencia de élite."; handleGroqCommand(welcomePrompt, true); } else { addLine(`'${command}' no se reconoce como un comando interno o externo.`, 'error-message'); createInputLine('C:\\>'); } }
        function handleAuditCommand(url) { if (!url) { addLine('Uso: auditar <URL>', 'error-message'); createInputLine('GROQ:\\> '); return; } addLine(`[AUDITORÍA DE SEGURIDAD] -> ${url}`, 'system-message'); addLine('Analizando superficie de ataque...', 'system-message'); setTimeout(() => { const report = generateAuditReport(url); const reportDiv = document.createElement('div'); reportDiv.className = 'audit-report'; reportDiv.innerHTML = `<strong>--- INFORME DE AUDITORÍA (SIMULADO) ---</strong><br><br>${report}`; document.getElementById('console').appendChild(reportDiv); document.getElementById('console').scrollTop = document.getElementById('console').scrollHeight; createInputLine('GROQ:\\> '); }, 2000); }
        function handleRevisarCommand(url) {
            if (!url) {
                addLine('Uso: revisar <URL>', 'error-message');
                createInputLine('GROQ:\\> ');
                return;
            }
            // --- MANEJO DE ERRORES MEJORADO ---
            let domain;
            try {
                domain = new URL(url).hostname;
            } catch (error) {
                addLine(`ERROR: URL inválida. Asegúrese de que incluya el protocolo (http:// o https://).`, 'error-message');
                createInputLine('GROQ:\\> ');
                return;
            }

            addLine(`[RECONOCIMIENTO PASIVO] -> ${url}`, 'system-message');
            addLine('Buscando enlaces y archivos expuestos...', 'system-message');
            setTimeout(() => {
                const discoveredLinks = simulateRecon(domain);
                const report = generateReconReport(domain, discoveredLinks);
                const reportDiv = document.createElement('div');
                reportDiv.className = 'recon-report';
                reportDiv.innerHTML = `<strong>--- INFORME DE RECONOCIMIENTO (SIMULADO) ---</strong><br><br>${report}`;
                document.getElementById('console').appendChild(reportDiv);
                document.getElementById('console').scrollTop = document.getElementById('console').scrollHeight;
                createInputLine('GROQ:\\> ');
            }, 2500);
        }
        function simulateRecon(domain) { const commonPaths = ['', 'admin', 'login', 'wp-admin', 'administrator', 'wp-login.php', 'config', 'backup', 'test', 'dev', 'api', 'robots.txt', 'sitemap.xml', '.env', '.git', 'database', 'uploads', 'images', 'css', 'js']; const commonFiles = ['index.html', 'index.php', 'home.html', 'main.html', 'config.php', 'wp-config.php', 'settings.py', 'database.sql', 'backup.sql', 'backup.zip', 'style.css', 'script.js', 'README.md']; let links = []; commonPaths.forEach(path => { commonFiles.forEach(file => { links.push(`${domain}/${path}/${file}`); }); links.push(`${domain}/${path}/`); }); links.push(`${domain}/`); return links; }
        function generateReconReport(domain, links) { let report = `Objetivo: ${domain}\n`; report += `Fecha: ${new Date().toISOString()}\n\n`; report += `<strong>Enlaces y Archivos Encontrados (${links.length}):</strong>\n`; links.slice(0, 30).forEach(link => { report += `- ${link}\n`; }); if (links.length > 30) { report += `- ... y ${links.length - 30} más.\n`; } report += `\n<strong>Diagnóstico de Seguridad Pasivo:</strong>\n`; if (links.some(l => l.includes('admin') || l.includes('wp-admin'))) { report += `- [ALTO] Se encontraron posibles paneles de administración.\n`; } if (links.some(l => l.includes('backup') || l.includes('.sql'))) { report += `- [CRÍTICO] Se encontraron posibles archivos de base de datos o backup.\n`; } if (links.some(l => l.includes('.env') || l.includes('config'))) { report += `- [CRÍTICO] Se encontraron posibles archivos de configuración sensibles.\n`; } if (links.some(l => l.includes('robots.txt'))) { report += `- [INFO] Archivo 'robots.txt' encontrado. Puede contener información sobre directorios que el propietario no quiere que se rastreen.\n`; } report += `\n<strong>Diagnóstico de Protección Anti-DDoS (Simulado):</strong>\n`; report += `- No se pueden realizar pruebas activas desde el cliente. Sin embargo, la exposición de paneles de administración y archivos sensibles sin protección sugiere una superficie de ataque vulnerable. Se recomienda implementar un WAF (Web Application Firewall) como Cloudflare o ModSecurity.`; return report; }
        function generateAuditReport(url) { const domain = new URL(url).hostname; const findings = [{ type: 'Panel de Administración', path: '/admin', risk: 'Alto' }, { type: 'Panel de Administración', path: '/wp-admin', risk: 'Alto' }, { type: 'Panel de Administración', path: '/administrator', risk: 'Alto' }, { type: 'Login', path: '/login', risk: 'Medio' }, { type: 'Configuración', path: '/config', risk: 'Medio' }, { type: 'Archivo de Robots', path: '/robots.txt', risk: 'Bajo' }, { type: 'API Restringida', path: '/api/v1/users', risk: 'Medio' }, { type: 'Backup', path: '/backup.sql', risk: 'Crítico' }]; let report = `Objetivo: ${url}<br>`; report += `Fecha: ${new Date().toISOString()}<br><br>`; report += `<strong>Puntos Finales Sensibles Encontrados:</strong><br>`; findings.forEach(finding => { report += `- [${finding.risk}] ${domain}${finding.path} (${finding.type})<br>`; }); report += `<br><strong>Recomendación:</strong><br>Realice una prueba de penetración manual para validar estos hallazgos.`; return report; }
        async function handleGroqCommand(query, isWelcomeMessage = false) { if (!isWelcomeMessage && !query) { createInputLine('GROQ:\\> '); return; } if (!isWelcomeMessage && isHostingQuery(query)) { addLine(NERVOX_PROMO, 'ai-response'); createInputLine('GROQ:\\> '); return; } if (!isWelcomeMessage && !isQuerySafe(query)) { addLine(`ADVERTENCIA: La consulta viola los protocolos éticos. Solicitud denegada.`, 'error-message'); createInputLine('GROQ:\\> '); return; } if (!isWelcomeMessage) { addLine(`[IA ANALYZING] -> ${query}`, 'system-message'); } let responseLine = document.createElement('div'); responseLine.className = 'ai-response'; document.getElementById('console').appendChild(responseLine); try { const response = await fetch('https://api.groq.com/openai/v1/chat/completions', { method: 'POST', headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${GROQ_API_KEY}` }, body: JSON.stringify({ messages: [{ role: "user", content: query }], model: "llama-3.3-70b-versatile", temperature: 1, max_completion_tokens: 1024, top_p: 1, stream: true, stop: null }), }); if (!response.ok) { throw new Error(`Error HTTP: ${response.status}`); } const reader = response.body.getReader(); const decoder = new TextDecoder(); while (true) { const { done, value } = await reader.read(); if (done) break; const chunk = decoder.decode(value); const lines = chunk.split('\n'); for (const line of lines) { if (line.startsWith('data: ')) { const data = line.slice(6); if (data === '[DONE]') continue; try { const json = JSON.parse(data); const content = json.choices[0].delta.content; if (content) { responseLine.textContent += content; document.getElementById('console').scrollTop = document.getElementById('console').scrollHeight; } } catch (e) {} } } } } catch (error) { console.error("Error al contactar Groq:", error); responseLine.textContent = `ERROR DE CONEXIÓN: ${error.message}`; responseLine.className = 'error-message'; } createInputLine('GROQ:\\> '); }
        window.addEventListener('load', () => { const savedUser = localStorage.getItem('sigiloUser'); if (savedUser) { currentUser = JSON.parse(savedUser); showConsole(); } });
    </script>
</body>
</html>
